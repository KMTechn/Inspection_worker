\# Inspection Worker - 품질 검사 시스템 (v2.0.8)

[![Python](https://img.shields.io/badge/Python-3.11+-blue.svg)](https://python.org)
[![License](https://img.shields.io/badge/License-Proprietary-red.svg)]()
[![Platform](https://img.shields.io/badge/Platform-Windows-lightgrey.svg)]()

KMTech 제조업 품질 검사를 위한 실시간 데스크톱 애플리케이션입니다.

> **📋 문서 구성**
> • **사용자 가이드**: 이 README의 하단부 ([🚀 프로그램 사용법](#🚀-프로그램-사용법) 섹션)
> • **개발자 가이드**: 이 README 전체 + `CLAUDE.md` 파일
> • **API 문서**: `tests/` 디렉토리의 테스트 코드



## 📝 프로그램 개요

**품질 검사 시스템**은 제조업 생산 라인에서 제품의 양품/불량을 실시간으로 기록하고 데이터를 관리하기 위해 개발된 전문 품질관리 솔루션입니다. 바코드 스캐너와 F12 풋 페달을 연동하여 빠르고 정확한 검사 작업이 가능하며, 모든 작업 내역은 자동으로 로그 파일로 저장되어 완벽한 추적성을 보장합니다.

### 🎯 핵심 가치
- **실시간 품질 데이터 수집**: 생산 현장의 모든 검사 데이터를 즉시 기록
- **하드웨어 통합**: 바코드 스캐너, 풋 페달과의 완벽한 연동
- **다중 모드 지원**: 표준검사, 리워크, 잔량처리, 불량품통합 모드
- **데이터 무결성**: 자동 저장, 복구 시스템으로 데이터 손실 방지

## 🏗️ 시스템 아키텍처

### 애플리케이션 구조

```
Inspection Worker (5,608 Lines)
├── ConfigManager (설정 관리)
├── InspectionProgram (메인 GUI - 260+ 메소드)
├── ui/ (UI 컴포넌트)
│   ├── base_ui.py (기본 UI 클래스)
│   └── components.py (특화 컴포넌트)
├── core/ (데이터 모델)
│   └── models.py (세션 데이터 구조)
└── utils/ (유틸리티)
    ├── logger.py (비동기 이벤트 로깅)
    ├── file_handler.py (파일 처리)
    └── exceptions.py (예외 계층)
```

### 핵심 컴포넌트 분석

| 컴포넌트 | 라인수 | 메소드수 | 주요 역할 |
|---------|--------|----------|-----------|
| **InspectionProgram** | ~5,400 | 260+ | 메인 GUI 및 비즈니스 로직 |
| **ConfigManager** | ~100 | 6 | JSON 기반 설정 관리 |
| **EventLogger** | ~115 | 6 | 비동기 이벤트 로깅 |
| **UI Components** | ~200 | 30+ | 재사용 가능한 UI 요소 |
| **Data Models** | ~55 | - | 세션 데이터 구조 |

### 데이터 플로우

```
바코드스캐너 → 메인앱 → 모드별처리 → UI업데이트 → 이벤트로깅 → CSV저장 → 오디오피드백
```

## 💻 개발 환경

### 시스템 요구사항

**운영체제**: Windows 10 이상
**Python**: 3.11+
**필수 디렉토리**: `C:\Sync` (로그 저장소)

### 의존성 설치

```bash
# 필수 패키지 설치
pip install -r requirements.txt

# 의존성 목록
requests    # GitHub API 통신
pygame     # 오디오 피드백
keyboard   # F12 페달 전역 후킹
Pillow     # 라벨 이미지 생성
qrcode     # QR코드 생성
```

### 개발 명령어

```bash
# 애플리케이션 실행
python Inspection_worker.py

# 전체 테스트 실행 (44개 테스트)
python tests/run_tests.py

# 모듈별 테스트
python tests/run_tests.py config       # 설정 테스트
python tests/run_tests.py models       # 데이터 모델 테스트
python tests/run_tests.py defect_mode  # 불량 모드 테스트
python tests/run_tests.py integration  # 통합 테스트

# 단일 테스트 클래스 실행
python -m unittest tests.test_models.TestInspectionSession

# 코드 품질 검사
python -m py_compile Inspection_worker.py
```

## 🔧 메소드 카테고리별 기능 분석

### 🎮 초기화 및 설정 (15개 메소드)
```python
__init__()                    # 전체 시스템 초기화
_setup_core_ui_structure()    # UI 구조 설정
load_app_settings()          # 설정 로드/저장
load_items()                 # 제품 DB 로드
```

### 🖥️ UI 구성 및 화면 관리 (25개 메소드)
```python
show_worker_input_screen()    # 로그인 화면
show_inspection_screen()      # 메인 검사 화면
_create_*_content()          # 각 패널 구성
_apply_mode_ui()             # 모드별 UI 적용
```

### 📱 바코드 스캔 처리 (20개 메소드)
```python
process_scan()               # 메인 스캔 처리
_process_scan_logic()        # 스캔 로직 분기
_process_inspection_scan()   # 표준 검사 스캔
_process_rework_scan()       # 리워크 스캔
```

### 📊 세션 및 데이터 관리 (35개 메소드)
```python
record_inspection_result()   # 검사 결과 기록
complete_session()          # 세션 완료
_save_current_session_state() # 상태 저장
_load_session_state()       # 상태 복구
```

### 🏷️ 라벨 생성 시스템 (15개 메소드)
```python
_generate_remnant_label_image()    # 잔량표 생성
_generate_defective_label_image()  # 불량표 생성
generate_defective_label()         # 불량표 로직
```

### 🧪 테스트 및 시뮬레이션 (45개 메소드)
```python
_automated_test_sequence()    # 자동화 테스트
_run_defect_mode_test()      # 불량 모드 테스트
_defect_merge_test_sequence() # 불량품 통합 테스트
```

### 📈 실시간 업데이트 (25개 메소드)
```python
_update_all_summaries()      # 전체 요약 업데이트
_update_center_display()     # 중앙 화면 업데이트
_start_stopwatch()          # 스톱워치 관리
_check_for_idle()           # 유휴 상태 체크
```

## 🎯 핵심 기능 상세

### ⚙️ 다중 모드 운영 시스템
- **표준 검사 모드**: 일반 품질 검사 워크플로우 (현품표 → 제품 스캔 → 완료)
- **리워크 모드**: 불량품 수리 후 재검사 처리
- **잔량 모드**: 남은 제품에 대한 잔량표 라벨 생성
- **불량품 통합 모드**: 48개 단위로 불량품 일괄 처리 및 불량표 생성

### 🔌 하드웨어 통합 기능
- **바코드 스캐너**: USB 연결 자동 인식, 실시간 바코드 처리
- **F12 풋 페달**: `keyboard` 라이브러리로 전역 후킹, 불량품 마킹
- **오디오 피드백**: `pygame.mixer` 기반 즉시 음성 안내 (성공/오류음)

### 📊 실시간 데이터 처리
- **실시간 현황판**: 진행률, 당일 통계, 평균 작업시간 표시
- **자동 저장**: 세션 상태 실시간 저장, 예기치 않은 종료시 복구
- **CSV 로깅**: 모든 검사 이벤트를 `C:\Sync`에 자동 저장

### 🧪 포괄적인 테스트 시스템
- **44개 단위 테스트**: 5개 모듈에 걸친 체계적 검증
- **통합 테스트**: 실제 작업 환경 시뮬레이션
- **특수 바코드**: 애플리케이션 내 테스트 명령어 (`_RUN_AUTO_TEST_` 등)

### 🔄 자동 업데이트 시스템
- **GitHub API 연동**: 릴리즈 자동 감지 및 다운로드
- **백그라운드 처리**: 사용자 작업 방해 없이 업데이트 적용
- **버전 관리**: `updater.bat` 스크립트로 안전한 업데이트

## 📁 파일 구조 및 데이터 관리

### 필수 시스템 디렉토리
```bash
C:\Sync/                           # 필수! 메인 로그 저장소
├── 검사작업이벤트로그_[작업자]_[날짜].csv    # 표준 검사 로그
├── 리워크작업이벤트로그_[작업자]_[날짜].csv  # 리워크 로그
└── labels/[YYYYMMDD]/            # 일별 라벨 저장
    ├── 현품표_[WID]_[시간].png      # 마스터 라벨
    ├── 불량표_[DEFECT-ID]_[시간].png # 불량품 라벨
    └── 잔량표_[SPARE-ID]_[시간].png  # 잔량 라벨
```

### 설정 및 자산 파일
```bash
assets/
├── Item.csv          # 제품 DB (필수)
├── *.wav            # 오디오 피드백 파일
├── *.png            # 제품 트레이 이미지
└── logo.ico         # 애플리케이션 아이콘

config/
└── inspection_settings.json  # UI 설정 (스케일, 컬럼 너비)
```

### ✨ 주요 기능 목록

* **바코드 기반 검사**: 현품표(마스터 라벨) 스캔으로 작업을 시작하고, 개별 제품 바코드를 스캔하여 검사를 진행합니다.

* **간편한 양품/불량 판정**: 기본 스캔은 **양품**, **`F12` 풋 페달**을 누른 상태의 스캔은 **불량**으로 자동 처리됩니다.

* **실시간 현황판**: 현재 트레이의 진행 상황, 당일 작업 통계, 평균 작업 시간 등을 실시간으로 확인할 수 있습니다.

* **리워크(Rework) 모드**: 불량으로 판정된 제품 중 수리가 완료된 제품을 별도로 관리하는 기능을 제공합니다.

* **작업 자동 저장 및 복구**: 예기치 않게 프로그램이 종료되어도 진행 중이던 작업 내용을 복구할 수 있습니다.

* **자동 업데이트**: 프로그램 실행 시 새로운 버전이 있으면 자동으로 감지하고 업데이트를 안내합니다.

* **사용자 맞춤 UI**: `Ctrl` + `마우스 휠` 스크롤로 화면 배율을 조절하여 보기 편한 크기로 설정할 수 있습니다.



---



\## 💻 시스템 요구사항 및 사전 준비



프로그램을 원활하게 사용하기 위해 다음 환경을 준비해야 합니다.



1\.  \*\*운영체제\*\*: Windows 10 이상

2\.  \*\*필수 폴더\*\*: \*\*`C:\\Sync`\*\* 폴더가 반드시 있어야 합니다. 모든 작업 기록(로그 파일)은 이 폴더에 저장됩니다. 폴더가 없다면 직접 생성해주세요.

3\.  \*\*하드웨어\*\*:

&nbsp;   \* 바코드 스캐너 (USB 타입 권장)

&nbsp;   \* `F12` 키를 출력하는 풋 페달 (USB 타입 권장)

4\.  \*\*프로그램 파일\*\*: 제공된 압축 파일을 해제하여 모든 파일(`Inspection\_worker.exe`, `assets` 폴더 등)이 같은 폴더 내에 있도록 배치합니다.



> ⚠️ \*\*중요\*\*: `assets` 폴더 내의 `Item.csv`, 사운드 파일 등은 프로그램 실행에 필수적이므로 절대 삭제하거나 위치를 변경하지 마십시오.



---



\## 🚀 프로그램 사용법



\### 1. 작업 시작 및 로그인



1\.  폴더에 있는 `Inspection\_worker.exe` 파일을 실행합니다.

2\.  화면에 나타나는 입력창에 \*\*본인의 작업자 이름\*\*을 정확하게 입력합니다.

3\.  `Enter` 키를 누르거나 '작업 시작' 버튼을 클릭합니다.







> \*\*💡 팁\*\*: 만약 이전에 비정상적으로 종료된 작업이 있다면, "이전 작업 복구" 여부를 묻는 창이 나타납니다. '예'를 누르면 작업 내용을 그대로 이어서 할 수 있습니다.



\### 2. 메인 화면 구성



로그인 후 나타나는 메인 화면은 크게 세 부분으로 나뉩니다.







\* \*\*(좌측) 작업 현황 패널\*\*:

&nbsp;   \* \*\*금일 작업 현황\*\*: 오늘 완료한 품목별 트레이(파렛트) 수량을 보여줍니다.

&nbsp;   \* \*\*불량 현황\*\*: 오늘 발생한 품목별 불량 개수를 보여줍니다.

\* \*\*(중앙) 메인 작업 패널\*\*:

&nbsp;   \* 현재 검사 중인 품목 정보와 진행률(카운트, 프로그레스 바)이 표시됩니다.

&nbsp;   \* 바코드를 스캔하는 메인 입력창이 위치합니다.

&nbsp;   \* 양품/불량으로 스캔된 제품 목록이 나타납니다.

\* \*\*(우측) 정보 및 상태 패널\*\*:

&nbsp;   \* 현재 시간, 작업 상태, 현재 트레이 소요 시간, 평균 완료 시간, 금주 최고 기록 등이 표시됩니다.



\### 3. 표준 검사 절차 (가장 중요!)



\*\*Step 1: 현품표(마스터 라벨) 스캔\*\*



\* 작업을 시작할 트레이(파렛트)의 \*\*현품표 QR코드\*\*를 스캔합니다.

\* 스캔이 성공하면 중앙 패널에 품목 정보가 표시되고, 검사를 시작할 준비가 완료됩니다.



\*\*Step 2: 제품 바코드 스캔\*\*



\* \*\*양품 판정\*\*: 제품 바코드를 \*\*그냥 스캔\*\*합니다. "삑" 하는 성공음과 함께 양품 목록에 추가됩니다.

\* \*\*불량 판정\*\*: \*\*`F12` 풋 페달을 밟은 상태\*\*에서 제품 바코드를 스캔합니다. 동일한 성공음과 함께 불량 목록에 추가됩니다.

&nbsp;   > ⚠️ \*\*핵심\*\*: 불량을 등록할 때는 반드시 \*\*`F12` 페달을 누른 채로\*\* 스캔해야 합니다! 페달을 누르면 '불량 모드 ON'이라는 안내가 잠시 나타납니다.



\*\*Step 3: 트레이 작업 완료\*\*



\* 현품표에 지정된 수량만큼 스캔을 완료하면 \*\*자동으로 현재 트레이가 제출\*\*되고, 다음 현품표를 스캔할 수 있는 대기 상태로 돌아갑니다.

\* 수량에 도달하기 전에 작업을 끝내려면 중앙 하단의 \*\*'✅ 현재 트레이 제출'\*\* 버튼을 누르세요.



\### 4. 리워크(Rework) 모드



리워크 모드는 이미 불량으로 판정된 제품을 수리하여 다시 양품으로 만드는 과정을 기록하기 위한 기능입니다.



1\.  \*\*모드 전환\*\*: 중앙 패널 우측 상단의 \*\*'리워크 모드'\*\* 버튼을 클릭합니다. 화면 전체가 보라색 톤으로 변경됩니다.

2\.  \*\*리워크 제품 스캔\*\*: 수리가 완료된 제품의 바코드를 스캔합니다.

3\.  \*\*기록 확인\*\*: 스캔된 제품은 '금일 리워크 완료 목록'에 추가됩니다.

4\.  \*\*모드 복귀\*\*: \*\*'검사 모드로'\*\* 버튼을 다시 눌러 표준 검사 모드로 돌아옵니다.



\### 5. 기타 주요 기능



\* \*\*↩️ 마지막 판정 취소\*\*: 바로 직전에 스캔한 판정(양품/불량)을 취소하고 이전 상태로 되돌립니다. 실수로 잘못 판정했을 때 사용합니다.

\* \*\*현재 작업 리셋\*\*: 현재 진행 중인 트레이의 모든 스캔 기록을 삭제하고 현품표 스캔 이전 상태로 초기화합니다.

\* \*\*작업자 변경\*\*: 현재 작업을 종료하고 다른 작업자가 로그인할 수 있도록 로그인 화면으로 돌아갑니다. 진행 중인 작업은 안전하게 저장됩니다.

\* \*\*완료 현황 보기\*\*: 좌측 상단의 '완료 현황 보기' 버튼을 클릭하면, 지정된 기간 동안 완료된 작업 내역을 날짜/차수/품목별로 조회할 수 있습니다.



---



\## 💡 유용한 팁 및 주의사항



\* \*\*UI 크기 조절\*\*: 화면의 글씨나 버튼이 너무 작거나 크다면, 키보드의 `Ctrl` 키를 누른 상태에서 마우스 휠을 위아래로 움직여 보세요. 자신에게 맞는 크기로 조절할 수 있습니다.

\* \*\*오류 발생 시\*\*: 스캔한 바코드가 품목과 맞지 않거나, 이미 스캔한 바코드일 경우 \*\*경고음과 함께 전체 화면에 오류 메시지\*\*가 나타납니다. 내용을 확인하고 '확인' 버튼을 눌러 작업을 계속하세요.

\* \*\*휴식 모드\*\*: 검사 중 7분(`IDLE\_THRESHOLD\_SEC = 420`) 이상 활동이 없으면 프로그램은 자동으로 '대기 중' 상태(노란색 UI)로 전환됩니다. 아무 바코드나 스캔하면 즉시 다시 작업 상태로 돌아옵니다.



---



\## ❓ 문제 해결 (FAQ)



\* \*\*Q: 프로그램을 실행했는데 `Item.csv` 파일을 찾을 수 없다고 나옵니다.\*\*

&nbsp;   \* A: 프로그램 실행 파일(`Inspection\_worker.exe`)이 있는 폴더에 `assets` 폴더가 있는지, 그 안에 `Item.csv` 파일이 있는지 확인해주세요. 파일이 없으면 프로그램을 정상적으로 사용할 수 없습니다.

\* \*\*Q: 바코드 스캐너가 작동하지 않습니다.\*\*

&nbsp;   \* A: 스캐너가 컴퓨터에 제대로 연결되었는지 확인하세요. 메모장(Notepad)을 열고 바코드를 스캔했을 때 글자가 입력되는지 테스트해보세요. 또한, 스캔하려는 입력창이 활성화되어 있는지 확인하세요.

\* \*\*Q: 이미 완료한 현품표를 다시 스캔하니 '작업 중복' 오류가 발생합니다.\*\*

&nbsp;   \* A: 시스템은 동일한 현품표의 중복 작업을 방지합니다. 이미 완료된 작업인지 확인하고, 새로운 현품표로 작업을 시작해주세요.



---



\## 📂 파일 구조 및 데이터 관리



\* \*\*로그 파일 위치\*\*: 모든 검사 기록 및 이벤트 로그는 `C:\\Sync` 폴더에 `검사작업이벤트로그\_작업자이름\_날짜.csv` 형식으로 저장됩니다.

\* \*\*데이터 중요성\*\*: 이 로그 파일들은 모든 작업의 증거 자료이므로 \*\*절대로 임의로 수정하거나 삭제하지 마세요.\*\*

\* \*\*설정 파일\*\*: 프로그램 창 크기, 스캔 딜레이 등의 설정은 프로그램 폴더 내 `config\\inspection\_settings.json` 파일에 저장됩니다.



---

\*이 매뉴얼이 품질 검사 작업에 도움이 되기를 바랍니다. 문제가 발생하거나 추가적인 지원이 필요한 경우 관리자에게 문의하십시오.\*

